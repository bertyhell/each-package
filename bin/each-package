#!/usr/bin/env node

var getopts = require('getopts-compat');

var options = getopts(process.argv.slice(2), {
  alias: { depth: 'd' },
  default: { depth: Infinity },
  stopEarly: true,
});

// define.option('-d, --depth <depth>', 'depth', parseInt, Infinity);

var args = options._;
if (!args.length) {
  console.log('Missing command. Example usage: each-package [command]');
  return process.exit(-1);
}

var eachPackage = require('..');

eachPackage(args[0], args.slice(1), options, function (err) {
  if (err) {
    console.log(err.message);
    return process.exit(err.code || -1);
  }
  process.exit(0);
});
